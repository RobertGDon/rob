---
---

// Google Fonts
@import url('https://fonts.googleapis.com/css?family=Raleway:200,400,400i,700,700i|Oswald');

// Basic Variables

$spacing-unit:          30px;

$base-font-family:      "Raleway", HelveticaNeue, sans-serif;
$base-font-size:        1.35rem;
$base-font-weight:      400;
$base-line-height:      1.4;
$base-line-length:      36em;

$header-font-weight:    600;

$caps-font-family:      "Oswald", Futura-CondensedMedium, sans-serif;

$perspective:           2000px;

// Colors

$brand-color:           firebrick; // #981212 better if want applied to page title as well
$shadow-color:          rgba(0, 0, 0, 0.6);

$gray-color:            #828282;
$gray-color-light:      lighten($gray-color, 40%);
$gray-color-dark:       darken($gray-color, 25%);

$fa-icons:              ({% for icon in site.data.icon-types %}
                            {{ icon.type }}: {{ icon.color }},{% endfor %}
                        );

// Images

$splash-image:          url({{ site.baseurl | append: '/media/backgrounds/mixing-board-angled.jpg' }});
$cta-image:             url({{ site.baseurl | append: '/media/backgrounds/mixing-board-straight.jpg' }});

$project-images:        ({% for project in site.projects %}
                            {{ project.slug }}: url({{ site.baseurl }}/{{ site.prose.media}}/{{ project.image }}),{% endfor %}
                        );

$image-bp:              ({% for size in site.image_bp %}
                            ({% for dimension in size %}
                                {{ dimension[0] }}: {{ dimension[1] }},
                            {% endfor %}),
                        {% endfor %});

// Layouts

$sizes: (
    "full":             100%,
    "screen":           100vw 100vh,
    "half-screen":      50vw 50vh,
    "no":               0,
);

$margins: (
    "auto":     auto,
    "0":        0,
    "s":        15px,
    "m":        30px,
    "l":        60px,
);

$paddings: (
    "xs":       10px,
    "s":        15px,
    "m":        30px,
    "l":        60px,
);

$borders: (
    "basic": (
        width: 1px,
        style: solid,
        color: inherit
    ),
    "thick": (
        width: 2px,
        style: solid,
        color: inherit
    ),
);

$themes: (
    light: (
        background-color: whitesmoke,
        text-color: #272727,
        font-size: 1.35rem,
        mobile: (
            font-size: 1.2rem,
        ),
    ),
    dark: (
        background-color: #151515,
        text-color: white,
    ),
    overlay: (
        background-color: rgba(black, 0.75),
        text-color: white,
    ),
    small: (
        font-size: 14px,
        line-height: 1.5,
    )
);

$base-theme: light;

$trans-default: .3s;
$trans-slow:    1s;
$trans-project: {{ site.project_transition_time }};

// Breakpoints

$bp: (
    //"x-large":  1800px,
    "large":    1000px,
    "laptop":   800px,
    "mobile":   600px,
);
$bp-laptop: map-get($bp, "laptop");
$bp-mobile: map-get($bp, "mobile");

// Mixins

$sides: "top", "bottom", "left", "right";
$side: null;

@function get-orientation($side) {
    @if $side == "top" or $side == "bottom" {
        @return "vertical";
    } @else if $side == "left" or $side == "right" {
        @return "horizontal";
    } @else {
        @error "Not a valid side."
    }
}

@mixin all-sides($class-name) {
    .#{$class-name} {
        @each $name in $sides {
            $side: $name !global;
            $o: str-slice(get-orientation($side), 1, 1);
            &, &-#{$o}, &-#{str-slice($side, 1, 1)} {
                @content;
            }
        }
    }
}

@function file-suffix ($file-name, $suffix) {
    $ext-index: str-index($file-name, ".");
    @if $ext-index {
        @return unquote(str-insert($file-name, $suffix, $ext-index));
    } @else {
        @warn "No extension found in file: #{$file-name}";
        @return unquote(#{$file-name}#{$suffix});
    }
}

@mixin theme-styles($styles, $background-color: null, $text-color: null) {
    @if map-has-key($styles, "background-color") or map-has-key($styles, "text-color") {
        @if map-has-key($styles, "background-color") {
            $background-color: map-get($styles, "background-color");
        }
        @if map-has-key($styles, "text-color") {
            $text-color: map-get($styles, "text-color");
        }
        $light-theme: lightness($text-color) < lightness($background-color);
        $styles: map-remove($styles, "background-color", "text-color");

        background-color: $background-color;
        color: $text-color;
        border-color: $text-color;

        @if $light-theme {
            -webkit-font-smoothing: subpixel-antialiased;
            -moz-osx-font-smoothing: auto;
        } @else {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }


        .theme-link {
            @if $light-theme {
                &:visited {
                    color: darken($brand-color, 25%);
                }

                &:hover {
                    color: darken($brand-color, 15%);
                }
            } @else {
                &:visited {
                    color: lighten($brand-color, 25%);
                }

                &:hover {
                    color: lighten($brand-color, 15%);
                }
            }
        }

        .text-light  &.text-light {
            @if $light-theme {
                color: lighten($text-color, 40%);
            } @else {
                color: darken($text-color, 40%);
            }
        }

        .border-light, &.border-light {
            @if $light-theme {
                border-color: darken($background-color, 10%);
            } @else {
                border-color: lighten($background-color, 10%);
            }
        }

        .border-x-light, &.border-x-light {
            @if $light-theme {
                border-color: darken($background-color, 5%);
            } @else {
                border-color: lighten($background-color, 5%);
            }
        }
    }

    @each $property, $value in $styles {
        @if type-of($value) == "map" {
            @if $property == "headings" or $property == "h" {
                & h1, h2, h3, h4, h5, h6 {
                    @include theme-styles($value, $background-color, $text-color);
                }
            } @else {
                @each $bp-name, $bp-value in $bp {
                    @if $property == $bp-name {
                        @media screen and (max-width: $bp-value) {
                            @include theme-styles($value, $background-color, $text-color);
                        }
                    }
                }
            }
        } @else {
            #{$property}: $value;
        }
    }

}

@mixin wrapper ($breakpoints, $min-margins: $spacing-unit) {
    $bp-first: nth($breakpoints, 1);
    $bp-last: nth($breakpoints, length($breakpoints));

    @if length($breakpoints) < 2 {
        @error "Invalid breakpoint list: must contain at least two values.";
    } @else if $bp-first < $bp-last {
        @error "Invalid breakpoint list: values should proceed from highest to lowest";
    }

    @extend .clearfix;
    margin-left: auto;
    margin-right: auto;
    max-width: $bp-first - ($min-margins * 2);

    @for $i from 1 to length($breakpoints) {
        $bp: nth($breakpoints, $i);
        $bp-next: nth($breakpoints, $i + 1);
        $query: null;
        $invalid: null;

        @if $bp < $bp-next {
            @error "Invalid breakpoint list: order must be consistent.";
        }

        @media screen and (max-width: $bp) {
            max-width: $bp-next - ($min-margins * 2);
        }
    }
}

@mixin fixed-ratio ($x, $y, $width: 100%) {
    @extend %fixed-ratio; // found in _layout partial
    width: $width;
    padding-top: $y/$x * $width;
}

@mixin columns-reset ($break-point) {
    //mobile reset
    @media screen and (max-width: $break-point) {
        .cell {
            display: block;

            .button {
                position: static;
                margin: 0 auto $spacing-unit;
            }
        }

        &.button-columns .cell {
            padding-bottom: 0;
        }
    }

    //desktop only: remove bottom margin of all last elements
    @media screen and (min-width: $break-point + 1px) {
        .cell > :last-child {
            margin-bottom: 0;
        }
    }
}

@mixin inline-columns ($columns, $spacing: 0) {
    @if not($columns > 1) { @error "inline-columns mixin must have more than one column." }
    $width: 100% / $columns;
    $row-end: $columns + "n";
    display: inline-block;
    width: calc(#{$width} - (#{$spacing} * (#{$columns} - 1) / #{$columns}));
    margin-right: $spacing;
    margin-bottom: $spacing;

    &:nth-child(#{$row-end}), &:last-child {
        margin-right: 0;
    }
}

@mixin blur($blur) {
    -webkit-filter: blur($blur);
    filter: blur($blur);
}

@mixin responsive-image ($image, $breakpoints: $image-bp) {
    @if str-slice($image, 1, 4) == "url(" {
        $image: str-slice($image, 5, -2);
    }

    // first
    $first: nth($breakpoints, 1);
    $x: #{map-get($first, x)};
    $y: #{map-get($first, y)};
    @media screen and (min-width: #{$x}px), screen and (min-height: #{$y}px) {
        background-image: url(#{$image});
    }

    // array values
    @for $i from 1 to length($breakpoints) {
        $current: nth($breakpoints, $i);
        $x: #{map-get($current, x)};
        $y: #{map-get($current, y)};
        $next: nth($breakpoints, $i + 1);
        $nx: #{map-get($next, x)};
        $ny: #{map-get($next, y)};
        @media screen and (max-width: #{$x}px) and (max-height: #{$y}px) and (min-width: #{$nx}px),
          screen and (max-width: #{$x}px) and (max-height: #{$y}px) and (min-height: #{$ny}px) {
            $suffix: "-#{$x}x#{$y}";
            background-image: url(file-suffix($image, $suffix));
        }
    }

    //last
    $last: nth($breakpoints, -1);
    $x: #{map-get($last, x)};
    $y: #{map-get($last, y)};
    @media screen and (max-width: #{$x}px) and (max-height: #{$y}px) {
        $suffix: "-#{$x}x#{$y}";
        background-image: url(file-suffix($image, $suffix));
    }

}

@mixin background-image ($image: none, $x: center, $y: center, $lighten: 0, $darken: 0, $blur: null) {

    @if $blur {
        @extend .relative, .overflow-h;

        &::after {
            $blur-offset: -$blur * 2;
            content: "";
            position: absolute;
            top: $blur-offset; left: $blur-offset; right: $blur-offset; bottom: $blur-offset;
            @include blur($blur);
            @include background-image($image, $x, $y, $lighten, $darken);
            z-index: -1;
        }
    } @else if $image != none {
        @if $lighten > 0 {
            background: linear-gradient(rgba(white, $lighten), rgba(white, $lighten)), $image;
        } @else if $darken > 0 {
            background: linear-gradient(rgba(black, $darken), rgba(black, $darken)), $image;
        } @else {
            background-image: $image;
        }
    } @else {
        @if $lighten > 0 {
            @extend .relative;

            &::after {
                content: "";
                position: absolute;
                top: 0; left: 0; right: 0; bottom: 0;
                background-color: rgba(255, 255, 255, $lighten);
                z-index: -1;
            }
        } @else if $darken > 0 {
            @extend .relative;

            &::after {
                content: "";
                position: absolute;
                top: 0; left: 0; right: 0; bottom: 0;
                background-color: rgba(0, 0, 0, $lighten);
                z-index: -1;
            }
        }
    }

    @if not($blur) {
        background-position: $x $y;
        background-repeat: no-repeat;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
    }
}

// This mixin applies the effects its contents when a element
// with class "hover" (either same element or a parent) is hovered
@mixin hover($hover-class: "hover") {
    &.#{$hover-class}:hover, .#{$hover-class}:hover & {
        @content
    }
}

// Partials

@import
    "base",
    "layout",
    "modules"
;
